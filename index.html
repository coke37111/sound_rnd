<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Spatial Audio Prototype</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app">
        <header>
            <h1>🎧 3D Spatial Audio Prototype</h1>
            <p>헤드폰을 착용하고 입체 음향을 경험해보세요!</p>
        </header>

        <div id="controls-info">
            <div class="key-group">
                <span class="key">A</span><span class="key">D</span>
                <span class="label">좌우 회전 (방위각)</span>
            </div>
            <div class="key-group">
                <span class="key">W</span><span class="key">S</span>
                <span class="label">위아래 회전 (고도)</span>
            </div>
            <div class="key-group">
                <span class="key">-</span><span class="key">+</span>
                <span class="label">거리 조절</span>
            </div>
            <div class="key-group">
                <span class="key">Space</span>
                <span class="label">소리 ON/OFF</span>
            </div>
            <div class="key-group">
                <span class="key">ESC</span>
                <span class="label">위치 초기화</span>
            </div>
        </div>

        <div id="start-screen">
            <button id="start-btn">🔊 시작하기</button>
            <p>클릭하여 오디오를 활성화하세요</p>
        </div>

        <div id="main-content" class="hidden">
            <div id="visualization">
                <canvas id="scene-canvas"></canvas>
                <div id="position-info">
                    <div id="spherical-info"><span id="spherical-coords">방위: 0° | 고도: 0°</span></div>
                    <div id="sound-pos">소리 위치: <span id="sound-coords">(0, 0, 5)</span></div>
                    <div id="listener-pos">리스너 위치: <span id="listener-coords">(0, 0, 0)</span></div>
                    <div id="distance">거리 (반지름): <span id="distance-value">5.0</span>m</div>
                </div>
            </div>

            <div id="audio-controls">
                <div class="control-group">
                    <label for="volume">볼륨</label>
                    <input type="range" id="volume" min="0" max="1" step="0.01" value="0.5">
                    <span id="volume-value">50%</span>
                </div>
                <div class="control-group">
                    <label for="sound-select">소리 종류</label>
                    <select id="sound-select">
                        <option value="sine">사인파 (Sine)</option>
                        <option value="square">사각파 (Square)</option>
                        <option value="sawtooth">톱니파 (Sawtooth)</option>
                        <option value="triangle">삼각파 (Triangle)</option>
                        <option value="noise">백색 소음 (White Noise)</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="frequency">주파수</label>
                    <input type="range" id="frequency" min="100" max="1000" step="10" value="440">
                    <span id="frequency-value">440 Hz</span>
                </div>
                <div class="control-group">
                    <label for="panning-model">패닝 모델</label>
                    <select id="panning-model">
                        <option value="HRTF">HRTF (머리 전달 함수)</option>
                        <option value="equalpower">Equal Power</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="distance-model">거리 모델</label>
                    <select id="distance-model">
                        <option value="inverse">역비례 (Inverse)</option>
                        <option value="linear">선형 (Linear)</option>
                        <option value="exponential">지수 (Exponential)</option>
                    </select>
                </div>
            </div>

            <div id="realism-controls">
                <h3>리얼리즘 설정</h3>
                <div class="controls-grid">
                    <div class="control-group">
                        <label>
                            <input type="checkbox" id="reverb-enabled" checked>
                            공간 반향 (Reverb)
                        </label>
                    </div>
                    <div class="control-group">
                        <label for="reverb-amount">반향 강도</label>
                        <input type="range" id="reverb-amount" min="0" max="1" step="0.05" value="0.3">
                        <span id="reverb-value">30%</span>
                    </div>
                    <div class="control-group">
                        <label for="room-type">공간 타입</label>
                        <select id="room-type">
                            <option value="small">작은 방</option>
                            <option value="medium" selected>중간 방</option>
                            <option value="large">큰 방</option>
                            <option value="hall">홀</option>
                            <option value="cathedral">대성당</option>
                        </select>
                    </div>
                    <div class="control-group">
                        <label>
                            <input type="checkbox" id="air-absorption" checked>
                            공기 흡수 (거리 필터)
                        </label>
                        <span class="filter-info">필터: <span id="filter-freq">없음</span></span>
                    </div>
                    <div class="control-group">
                        <label>
                            <input type="checkbox" id="front-back-filter" checked>
                            앞/뒤 구분 강화
                        </label>
                        <span class="filter-info">뒤: <span id="back-level">0%</span></span>
                    </div>
                    <div class="control-group angle-intensity-group">
                        <label>각도별 효과 강도 (귀 모양 보정)</label>
                        <div class="angle-sliders">
                            <div class="angle-slider">
                                <span class="angle-label">0°</span>
                                <input type="range" id="intensity-0" min="0" max="3" step="0.1" value="0">
                                <span class="angle-value" id="intensity-0-value">0%</span>
                            </div>
                            <div class="angle-slider">
                                <span class="angle-label">30°</span>
                                <input type="range" id="intensity-30" min="0" max="3" step="0.1" value="0">
                                <span class="angle-value" id="intensity-30-value">0%</span>
                            </div>
                            <div class="angle-slider">
                                <span class="angle-label">60°</span>
                                <input type="range" id="intensity-60" min="0" max="3" step="0.1" value="0">
                                <span class="angle-value" id="intensity-60-value">0%</span>
                            </div>
                            <div class="angle-slider">
                                <span class="angle-label">90°</span>
                                <input type="range" id="intensity-90" min="0" max="3" step="0.1" value="0.5">
                                <span class="angle-value" id="intensity-90-value">50%</span>
                            </div>
                            <div class="angle-slider">
                                <span class="angle-label">120°</span>
                                <input type="range" id="intensity-120" min="0" max="3" step="0.1" value="1">
                                <span class="angle-value" id="intensity-120-value">100%</span>
                            </div>
                            <div class="angle-slider">
                                <span class="angle-label">150°</span>
                                <input type="range" id="intensity-150" min="0" max="3" step="0.1" value="1.5">
                                <span class="angle-value" id="intensity-150-value">150%</span>
                            </div>
                            <div class="angle-slider">
                                <span class="angle-label">180°</span>
                                <input type="range" id="intensity-180" min="0" max="3" step="0.1" value="2">
                                <span class="angle-value" id="intensity-180-value">200%</span>
                            </div>
                        </div>
                        <div class="current-intensity">
                            현재 적용 강도: <span id="front-back-value">0%</span>
                        </div>
                    </div>
                </div>
            </div>

            <div id="advanced-controls">
                <h3>고급 설정</h3>
                <div class="controls-grid">
                    <div class="control-group">
                        <label for="rolloff-factor">거리 감쇠율</label>
                        <input type="range" id="rolloff-factor" min="0" max="5" step="0.1" value="1">
                        <span id="rolloff-value">1.0</span>
                    </div>
                    <div class="control-group">
                        <label for="ref-distance">기준 거리</label>
                        <input type="range" id="ref-distance" min="0.5" max="10" step="0.5" value="1">
                        <span id="ref-dist-value">1.0m</span>
                    </div>
                    <div class="control-group">
                        <label for="air-absorption-coeff">공기 흡수 계수</label>
                        <input type="range" id="air-absorption-coeff" min="0.1" max="2" step="0.1" value="0.5">
                        <span id="air-coeff-value">0.50</span>
                    </div>
                    <div class="control-group">
                        <label for="stereo-width">스테레오 폭</label>
                        <input type="range" id="stereo-width" min="0" max="2" step="0.1" value="1">
                        <span id="stereo-value">100%</span>
                    </div>
                    <div class="control-group">
                        <label for="reverb-decay">리버브 길이</label>
                        <input type="range" id="reverb-decay" min="0.5" max="8" step="0.5" value="2">
                        <span id="decay-value">2.0s</span>
                    </div>
                    <div class="control-group">
                        <label for="reverb-damping">고주파 감쇠</label>
                        <input type="range" id="reverb-damping" min="0" max="1" step="0.1" value="0.5">
                        <span id="damping-value">50%</span>
                    </div>
                    <div class="control-group">
                        <label for="early-reflection">초기 반사음 딜레이</label>
                        <input type="range" id="early-reflection" min="0.005" max="0.1" step="0.005" value="0.02">
                        <span id="early-ref-value">20ms</span>
                    </div>
                    <div class="control-group">
                        <label for="early-reflection-gain">초기 반사음 볼륨</label>
                        <input type="range" id="early-reflection-gain" min="0" max="1" step="0.05" value="0.3">
                        <span id="early-gain-value">30%</span>
                    </div>
                    <div class="control-group">
                        <label for="audio-file">오디오 파일</label>
                        <input type="file" id="audio-file" accept="audio/*">
                    </div>
                </div>
            </div>

            <div id="status">
                <span id="audio-status" class="status-off">🔇 소리 꺼짐</span>
            </div>
        </div>
    </div>

    <script src="spatial-audio.js"></script>
</body>
</html>
